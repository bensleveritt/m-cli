#!/usr/bin/env bash

# TODO: add more functionalities

source "$( dirname "${BASH_SOURCE[0]}" )/../lib/defaults.sh"
source "$( dirname "${BASH_SOURCE[0]}" )/../lib/helpers.sh"

help(){
    cat<<__EOF__
    usage: m finder [ showhiddenfiles | showfileextensions | showdesktop | help ]

    Examples:
      m finder showhiddenfiles           # get the current status
      m finder showhiddenfiles YES       # show hidden files
      m finder showhiddenfiles NO        # don't show hidden files

      m finder showextensions            # get the current status
      m finder showextensions YES        # show all file extensions
      m finder showextensions NO         # don't show all file extensions

      m finder showdesktop               # get the current desktop status
      m finder showdesktop YES           # enable the desktop
      m finder showdesktop NO            # disable the desktop
__EOF__
}

hidden_files(){
    local choice="$(_mcli_yes_no_to_boolean "$1")"

    defaults write com.apple.finder AppleShowAllFiles -bool "${choice}"

    [ -n "$1" ] && killall Finder

    value="$(_mcli_read_boolean_as_yes_no "com.apple.finder" "AppleShowAllFiles")"

    echo "Finder showhiddenfiles: ${value}"
}

file_extensions(){
    local choice="$(_mcli_yes_no_to_boolean "$1")"

    defaults write NSGlobalDomain AppleShowAllExtensions -bool "${choice}"

    [ -n "$1" ] && killall Finder

    value="$(_mcli_read_boolean_as_yes_no "NSGlobalDomain" "AppleShowAllExtensions")"

    echo "Finder showextensions: ${value}"
}

desktop(){
    local choice="$(_mcli_yes_no_to_boolean "$1")"

    defaults write com.apple.finder CreateDesktop -bool "${choice}"

    [ -n "$1" ] && killall Finder

    value="$(_mcli_read_boolean_as_yes_no "com.apple.finder" "CreateDesktop")"

    echo "Finder showdesktop: ${value}"
}

case $1 in
    help)
        help
        ;;
    showhiddenfiles)
        shift
        hidden_files "$@"
        ;;
    showextensions)
        shift
        file_extensions "$@"
        ;;
    showdesktop)
        shift
        desktop "$@"
        ;;
    *)
        help
        ;;
esac

# vim: ts=4 sw=4 softtabstop=4 expandtab
