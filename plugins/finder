#!/usr/bin/env bash

# TODO: add more functionalities

source "$( dirname "${BASH_SOURCE[0]}" )/../lib/defaults.sh"
source "$( dirname "${BASH_SOURCE[0]}" )/../lib/converters.sh"

help(){
    cat<<__EOF__
    usage: m finder [ showhiddenfiles | showfileextensions | showdesktop | help ]

    Examples:
      m finder showhiddenfiles           # get the current status
      m finder showhiddenfiles YES       # show hidden files
      m finder showhiddenfiles NO        # don't show hidden files

      m finder showextensions            # get the current status
      m finder showextensions YES        # show all file extensions
      m finder showextensions NO         # don't show all file extensions

      m finder showdesktop               # get the current desktop status
      m finder showdesktop YES           # enable the desktop
      m finder showdesktop NO            # disable the desktop
__EOF__
}

hidden_files(){
    value="$(_mcli_defaults_yes_no_to_boolean "com.apple.finder" \
                                              "AppleShowAllFiles" \
                                              "$1")"

    [ -n "$1" ] && killall Finder

    echo "Finder showhiddenfiles: ${value}"
}

file_extensions(){
    value="$(_mcli_defaults_yes_no_to_boolean "NSGlobalDomain" \
                                              "AppleShowAllExtensions" \
                                              "$1")"

    [ -n "$1" ] && killall Finder

    echo "Finder showextensions: ${value}"
}

desktop(){
    value="$(_mcli_defaults_yes_no_to_boolean "com.apple.finder" \
                                              "CreateDesktop" \
                                              "$1")"

    [ -n "$1" ] && killall Finder

    echo "Finder showdesktop: ${value}"
}

case $1 in
    help)
        help
        ;;
    showhiddenfiles)
        shift
        hidden_files "$@"
        ;;
    showextensions)
        shift
        file_extensions "$@"
        ;;
    showdesktop)
        shift
        desktop "$@"
        ;;
    *)
        help
        ;;
esac

# vim: ts=4 sw=4 softtabstop=4 expandtab
